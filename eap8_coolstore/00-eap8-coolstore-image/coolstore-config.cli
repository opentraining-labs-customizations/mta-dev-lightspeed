embed-server --std-out=echo

# -------------------------------------------------
# Register PostgreSQL JDBC driver (MODULE-BASED)
# -------------------------------------------------
/subsystem=datasources/jdbc-driver=postgresql:add(driver-name=postgresql,driver-module-name=org.postgresql,driver-class-name=org.postgresql.Driver)

# -------------------------------------------------
# Datasource
# -------------------------------------------------
/subsystem=datasources/data-source=CoolstoreDS:add(jndi-name=java:/jboss/datasources/CoolstoreDS,driver-name=postgresql,connection-url=jdbc:postgresql://postgres:5432/mydb,user-name=myuser,password=mypassword)

# -------------------------------------------------
# ActiveMQ Resource Adapter
# -------------------------------------------------
#/subsystem=resource-adapters/resource-adapter=activemq-ra:add(archive=activemq-rar.rar, transaction-support=XATransaction)

#/subsystem=resource-adapters/resource-adapter=activemq-ra/connection-definitions=AMQConnectionFactory:add(class-name=org.apache.activemq.ra.ActiveMQManagedConnectionFactory, jndi-name=java:/JmsXA,enabled=true)

#/subsystem=resource-adapters/resource-adapter=activemq-ra/connection-definitions=AMQConnectionFactory/config-properties=ServerUrl:add(value="tcp://amq-broker:61616")
# -------------------------------------------------
# CREATE ARTEMIS SERVER (THIS WAS MISSING)
# -------------------------------------------------
#/subsystem=messaging-activemq/server=default:add(persistence-enabled=false)
/subsystem=messaging-activemq/server=default:add(persistence-enabled=false, security-enabled=false)


# -------------------------------------------------
# JMS Topic (EAP 8 WAY)
# -------------------------------------------------
#/subsystem=resource-adapters/resource-adapter=activemq-ra/admin-objects=ordersTopic:add(class-name=org.apache.activemq.command.ActiveMQTopic,jndi-name=java:/topic/orders)


# -------------------------------------------------
# JMS Topic (EAP 8 / Artemis)
# -------------------------------------------------
/subsystem=messaging-activemq/server=default/jms-topic=orders:add(entries=["java:/topic/orders"])

# -------------------------------------------------
# ActiveMQ Resource Adapter (MDBs NEED THIS)
# -------------------------------------------------
/subsystem=resource-adapters/resource-adapter=activemq-ra:add(archive=activemq-rar.rar, transaction-support=XATransaction)

/subsystem=resource-adapters/resource-adapter=activemq-ra/connection-definitions=AMQCF:add(class-name=org.apache.activemq.ra.ActiveMQManagedConnectionFactory, jndi-name=java:/JmsXA, enabled=true)

/subsystem=resource-adapters/resource-adapter=activemq-ra/connection-definitions=AMQCF/config-properties=ServerUrl:add( value="vm://0" )



stop-embedded-server

